<!DOCTYPE html>
<html lang="en">
<head>  
    <script 
        src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" 
        integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" 
        crossorigin="anonymous">
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Someone to Talk</title>
    <!-- <link rel="stylesheet" href="styleGeneral.css"> -->
    <!-- <link rel="stylesheet" href="talkSelection.css"> -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styleGeneral.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='talkSelection.css') }}">
</head>
<body>
    <section class="genSec">
        <h3>Find Someone to Talk</h3>
        <main>
            <input type="search" name="searching" id="searching" placeholder="Looking for...">
            <button class="go">Go</button>
            <section class="usersSections">
                <div>
                <form method="get" action="{{url_for('chat')}}" acttion="{{url_for('success')}}">
                    {% for username in usernames %}
                    <p class="onlineUsers">{{ loop.index }}) {{ username }} <span>...</span>
                    <button type="submit" class="talkButton" id="45" name="rec" value="{{ loop.index }} {{username}}" onClick="initateRequest()">
                        Talk
                    </button></p>
                    {% endfor %}
                </form>
            </div>
            </section>
            <div class="request">
            </div>
        </main>

        <section class="profile">
            <p class="user" data-value="{{user}}">{{user}}</p>
            <button class="viewProfile">View Profile</button>
        </section>
    </section>
<script>
    let socketio = io()
    const request = document.querySelector('.request')
    const createRequest = (username) =>{
        const content =`
        <h2>${username}</h2>
        <button>Ye</button>
        <button>No</button>
        `
        request.innerHTML = content
    }
    socketio.on('talk_request', (see) =>{
        createRequest(see.username)})

    const initateRequest = () =>{
        
        const button = document.getElementById('45');
        const username = button.value.split(' ')[1]; 
        console.log(username)
        alert('hey')
        socketio.emit("talk_request", {see: username})}
</script>
{% for r in content %}
<script>
    createRequest('{{r.username}}')
</script>
{% endfor %}
</body>
</html>
